### 享元模式



#### 介绍

享元模式通过为相似对象引入数据共享来最小化内存使用，提升性能，**一个享元**就是一个包含状态的独立的不可变数据的共享对象，依赖状态的可变数据不应是享元的一部分，因为每个对象的这种信息不相同，无法共享，如果享元需要非固有数据应该由客户端代码显示提供。

例如我们正在设计一个性能为关键的游戏，例如第一人称设计游戏（FPS），在FPS游戏中，玩家（士兵）共享一些状态，如外在的表现和行为。例如在 CS 游戏中，同一团队的所有士兵看起来都是一样的，所有的士兵都有一些共同 的动作，比如，低头，跳跃等，这意味着我们可以创建一个享元来包含所有的共同数据，当然，士兵也有许多因人而异的数据，这些数据不是享元的一部分，比如，枪支/健康状况和地理位置等。



#### 应用场景

享元旨在优化性能和内存的使用。所有的嵌入式系统（如手机，平板，游戏终端和微控制器等）还有和性能相关的应用，如游戏，3D图形处理和实时系统等，都能从其中获益。

享元模式的使用条件：

- 应用需要使用大量的对象
- 对象太多，存储/渲染它们的代价太大，一旦移除对象中的可变形态，多组不同的对象可以被相对更少的共享对象所替代。
- 对象的ID对于应用不重要，对象共享改会造成ID的比较失败，所以不能依赖对象的ID。